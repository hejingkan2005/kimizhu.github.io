<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>Wiimote Library for Developers on Coding4Fun</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/Dan Fernandez - MSFT' target='_blank'>Dan Fernandez - MSFT</a>
<time>    3/14/2007 1:12:00 PM</time>
<hr>
<div id='content'><P><IMG src="http://www.coding4fun.net/images/ManagedLibraryforNintendosWiimote_E0DF/wmtester1.png" mce_src="http://www.coding4fun.net/images/ManagedLibraryforNintendosWiimote_E0DF/wmtester1.png"> </P>
<P><A href="http://brianpeek.com/blogs/default.aspx" mce_href="http://brianpeek.com/blogs/default.aspx">Brian Peek</A> just published his latest article, a <A href="http://msdn.microsoft.com/coding4fun/hardware/article.aspx?articleid=1879033" mce_href="http://msdn.microsoft.com/coding4fun/hardware/article.aspx?articleid=1879033">.NET library for easy programming of a Nintendo Wiimote controller</A>. His article and project on Channel9 includes the full source code for the library and how he built everything. The cool part is of course how easy it is to use the library as shown below...<BR></P>
<OL>
<LI><STRONG>Create a Wiimote class </STRONG></LI><PRE class=csharpcode>VB: <SPAN class=kwrd>Dim</SPAN> <SPAN class=kwrd>WithEvents</SPAN> wm <SPAN class=kwrd>As</SPAN> Wiimote = <SPAN class=kwrd>New</SPAN> Wiimote()</PRE><PRE class=csharpcode>C#: Wiimote wm = <SPAN class=kwrd>new</SPAN> Wiimote();<BR></PRE>
<STYLE type=text/css>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</STYLE>

<STYLE type=text/css>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</STYLE>

<LI><STRONG>Connect to the controller</STRONG><BR>VB: wm.Connect()<BR>C#: wm.Connect();<BR></LI>
<STYLE type=text/css>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</STYLE>

<LI><STRONG>Add an event handler for the OnWiimoteChanged event</STRONG></LI><PRE class=csharpcode><SPAN class=kwrd><FONT color=#000000>VB: </FONT>Private</SPAN> <SPAN class=kwrd>Sub</SPAN> wm_OnWiimoteChanged(<SPAN class=kwrd>ByVal</SPAN> sender <SPAN class=kwrd>As</SPAN> System.<SPAN class=kwrd>Object</SPAN>, <SPAN class=kwrd>ByVal</SPAN> e <SPAN class=kwrd>As</SPAN> WiimoteChangedEventArgs) <SPAN class=kwrd>Handles</SPAN> wm.OnWiimoteChanged</PRE><PRE class=csharpcode>C#: wm.OnWiimoteChanged += <SPAN class=kwrd>new</SPAN> WiimoteChangedEventHandler(wm_OnWiimoteChanged);<BR></PRE>
<STYLE type=text/css>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</STYLE>

<STYLE type=text/css>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</STYLE>

<LI><STRONG>Poll the Wiimote State<BR></STRONG><BR>VB/C#: wm.WiimoteState.ButtonState.A</LI>
<STYLE type=text/css>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</STYLE>
</OL>
<P mce_keep="true">&nbsp;</P>
<P>You can find a Wiimote Test project that walks through all of the properties available (that's the screenshot above) in <A href="https://channel9.msdn.com/ShowPost.aspx?PostID=291133" mce_href="https://channel9.msdn.com/ShowPost.aspx?PostID=291133">Brian's download as well.</A> Here's a very quick example that pops a message box if you hit the <STRONG>A button.<BR></STRONG></P>
<P><STRONG>VB Code that checks if Button A is pressed</STRONG></P>
<DIV class=csharpcode><PRE class=alt><SPAN class=kwrd>Imports</SPAN> WiimoteLib</PRE><PRE><SPAN class=kwrd>Imports</SPAN> System.Windows.Forms</PRE><PRE class=alt>&nbsp;</PRE><PRE><SPAN class=kwrd>Public</SPAN> <SPAN class=kwrd>Class</SPAN> Form2</PRE><PRE class=alt>    <SPAN class=rem>'Wiimote Class</SPAN></PRE><PRE>    <SPAN class=kwrd>Dim</SPAN> <SPAN class=kwrd>WithEvents</SPAN> wm <SPAN class=kwrd>As</SPAN> Wiimote = <SPAN class=kwrd>New</SPAN> Wiimote()</PRE><PRE class=alt>&nbsp;</PRE><PRE>    <SPAN class=kwrd>Private</SPAN> <SPAN class=kwrd>Sub</SPAN> Form2_Load(<SPAN class=kwrd>ByVal</SPAN> sender <SPAN class=kwrd>As</SPAN> System.<SPAN class=kwrd>Object</SPAN>, <SPAN class=kwrd>ByVal</SPAN> e <SPAN class=kwrd>As</SPAN> System.EventArgs) <SPAN class=kwrd>Handles</SPAN> <SPAN class=kwrd>MyBase</SPAN>.Load</PRE><PRE class=alt>        wm.Connect()</PRE><PRE>    <SPAN class=kwrd>End</SPAN> <SPAN class=kwrd>Sub</SPAN></PRE><PRE class=alt>&nbsp;</PRE><PRE>    <SPAN class=kwrd>Private</SPAN> <SPAN class=kwrd>Sub</SPAN> wm_OnWiimoteChanged(<SPAN class=kwrd>ByVal</SPAN> sender <SPAN class=kwrd>As</SPAN> System.<SPAN class=kwrd>Object</SPAN>, <SPAN class=kwrd>ByVal</SPAN> e <SPAN class=kwrd>As</SPAN> WiimoteChangedEventArgs) <SPAN class=kwrd>Handles</SPAN> wm.OnWiimoteChanged</PRE><PRE class=alt>        <SPAN class=kwrd>If</SPAN> (wm.WiimoteState.ButtonState.A = <SPAN class=kwrd>True</SPAN>) <SPAN class=kwrd>Then</SPAN></PRE><PRE>            MessageBox.Show(<SPAN class=str>"You pressed the A button!"</SPAN>)</PRE><PRE class=alt>        <SPAN class=kwrd>End</SPAN> <SPAN class=kwrd>If</SPAN></PRE><PRE>    <SPAN class=kwrd>End</SPAN> <SPAN class=kwrd>Sub</SPAN></PRE><PRE class=alt><SPAN class=kwrd>End</SPAN> Class</PRE></DIV>
<P>
<STYLE type=text/css>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }
</STYLE>
</P>
<P><STRONG>C# Code that checks if Button A is pressed</STRONG></P><PRE class=csharpcode><SPAN class=kwrd>public</SPAN> <SPAN class=kwrd>partial</SPAN> <SPAN class=kwrd>class</SPAN> Form2 : Form
{
    <SPAN class=kwrd>public</SPAN> Form2()
    {
        InitializeComponent();
    }

    Wiimote wm = <SPAN class=kwrd>new</SPAN> Wiimote();
    <SPAN class=kwrd>private</SPAN> <SPAN class=kwrd>void</SPAN> Form2_Load(<SPAN class=kwrd>object</SPAN> sender, EventArgs e)
    {            
        <SPAN class=rem>//use this to listen to Wiimote events</SPAN>
        wm.OnWiimoteChanged += <SPAN class=kwrd>new</SPAN> WiimoteChangedEventHandler(wm_OnWiimoteChanged);
        wm.Connect();
    }

    <SPAN class=kwrd>void</SPAN> wm_OnWiimoteChanged(<SPAN class=kwrd>object</SPAN> sender, WiimoteChangedEventArgs args)
    {            
        <SPAN class=kwrd>if</SPAN> (wm.WiimoteState.ButtonState.A == <SPAN class=kwrd>true</SPAN>)
        {
            MessageBox.Show(<SPAN class=str>"You pressed the A button!"</SPAN>);                
        }
    }
}</PRE><PRE class=csharpcode>&nbsp;</PRE><PRE class=csharpcode>&nbsp;</PRE></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
