<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>Expansions Part 2: Filtered Completion Lists</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/Dan Fernandez - MSFT' target='_blank'>Dan Fernandez - MSFT</a>
<time>    11/12/2003 2:41:00 AM</time>
<hr>
<div id='content'><body xmlns="http://www.w3.org/1999/xhtml">
    <p>
        I noticed a great&#160;question from <a href="http://www.hutteman.com/weblog/">Luke
        Hutteman</a> (of <a href="http://www.sharpreader.com">SharpReader</a> fame) on <a href="http://www.sellsbrothers.com">Chris
        Sells blog</a>.&#160; His question is: 
        <br />
        <i>
        <br />
        "Will VS.NET also (like IDEA) be smart enough to give me a dropdown with appropriate
        values for the template-variables? That is, if the template calls for an IList somewhere,
        will it show a dropdown with all IList-type variables that are in scope at that time?"</i> 
    </p>
    <p>
        <strong>Note</strong>: If you're interested in the basics of creating expansions,
        check out my <a href="http://blogs.gotdotnet.com/danielfe/PermaLink.aspx/33c7ddb6-641b-42d9-a879-bd1ae884c3ab">first
        blog entry on expansions</a>. 
    </p>
    <p>
        Back to Luke's question, the answer is yes&#160;it will.&#160; In fact, the foreach
        expansion does exactly that by showing objects that implement the IEnumerable interface
        within the specific scope where the expansion was called.&#160; To do this, you can
        add a&#160;&lt;function&gt;&lt;/function&gt; tag to the&#160;literal variable declaration&#160;and
        use the built-in&#160;function ListVariablesOfType(<em>type</em>)<em>.&#160; </em>Below
        is a fragment of the XML markup of the foreach expansion:&#160; 
    </p>
    <p>
        <code>&lt;literal&gt;<br />
        &#160;&#160;&#160;&lt;id&gt;collection&lt;/id&gt;<br />
        &#160;&#160;&#160;&lt;tooltip&gt;Name of collection or array to iterate through&lt;/tooltip&gt;<br />
        &#160;&#160;&#160;&lt;function&gt;<strong>ListVariablesOfType(System.Collections.IEnumerable)</strong>&lt;/function&gt;<br />
        &#160;&#160;&#160;&lt;default&gt;collection_to_loop&lt;/default&gt;<br />
        &#160;&#160;&lt;/literal&gt; </code>
    </p>
    <p>
        When the expansion is invoked and the user tabs to the collection variable, they will
        see a list of IEnumerable collections. 
    </p>
    <p>
        The code section&#160;for the foreach expansion (below) is straighforward with the
        collection literal being declared the same as any other variable. 
    </p>
    <p>
        <code>&#160;&#160;&lt;code language="csharp"&gt;<br />
        &#160;&#160;&#160;&lt;![CDATA[foreach ($type$ $indentifier$ in $collection$)<br />
        &#160;&#160;{<br />
        &#160;&#160;&#160;$selected$ $end$<br />
        &#160;&#160;}]]&gt;<br />
        &#160;&#160;&lt;/code&gt; </code>
    </p>
    <p>
        PS: If you still want to code in C# but want to use <a href="http://www.jetbrains.com">IDEA</a> tools
        instead of VS, this <a href="http://home.yole.ru/weblog/archives/000096.html">post</a> makes
        it sound like we'll soon have a version of IntelliJ for C# :) 
    </p>
    <p>
    </p>
</body></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
