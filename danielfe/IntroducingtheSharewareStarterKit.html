<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>Introducing the Shareware Starter Kit</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/Dan Fernandez - MSFT' target='_blank'>Dan Fernandez - MSFT</a>
<time>    7/10/2005 5:58:00 PM</time>
<hr>
<div id='content'><P><FONT face=Arial size=2>I'm way, way late on this, but</FONT> <FONT face=Arial size=2>w</FONT><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">e have officially released the Shareware Starter Kit on Channel9!!</SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Download:&nbsp;(<A href="https://channel9.msdn.com/pdc/contest/SSKCSharp.exe">C# download</A>, <A href="https://channel9.msdn.com/pdc/contest/SSKVB.exe">VB download</A>). </SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">The Shareware Starter Kit is a sample application of the common features in all shareware applications. You can easily modify, extend and integrate these into your own applications. The Channel9 guys even have a contest where you can write code to use the Shareware Starter Kit and <A href="https://channel9.msdn.com/ShowPost.aspx?PostID=74805">code your way to a free ticket to the PDC</A>.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN><a href="http://blogs.msdn.com/mglehman/">Michael Lehman</A> also has a <A href="https://channel9.msdn.com/ShowPost.aspx?PostID=74998">video walkthrough of the Shareware Starter Kit</A>.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>After installing the application, make sure to read the SSK Developer Documentation for a full overview of everything it can do.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Both Michael, <?xml:namespace prefix = st1 ns = "urn:schemas-microsoft-com:office:smarttags" /><st1:PersonName w:st="on">Jed Rose</st1:PersonName>, and I will be at the <A href="http://www.sic.org/">Shareware Industry Conference</A> in <st1:place w:st="on"><st1:City w:st="on">Denver</st1:City>, <st1:State w:st="on">Colorado</st1:State></st1:place> later this week (ping me if you’re interested in a nerd dinner).<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><STRONG><FONT size=3>Key Features</FONT></STRONG></SPAN></P>
<P><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial">Multi-Threaded Splash Screen<BR></SPAN></B><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><FONT size=2>A sample Windows Form that shows how you can use a timer control to create a beautiful fade-in/fade-out effect. <o:p></o:p></FONT></SPAN></P><IMG src="http://www.danfernandez.com/view/view.aspx?ID=142"> 
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><o:p></o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial">Integrated E-Commerce <o:p></o:p></SPAN></B></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><FONT size=2>This feature makes purchasing a licensed copy of your software just a click away by integrating </FONT><A href="http://www.paypal.com/"><FONT size=2>PayPal’s</FONT></A><FONT size=2> payment services directly into the client application using Web services.<o:p></o:p></FONT></SPAN></P><IMG src="http://www.danfernandez.com/view/view.aspx?ID=143"> 
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial">Product Activation <o:p></o:p></SPAN></B></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><FONT size=2>Many shareware applications enable to try-before-you-buy, and this feature enables developers to control how you want to configure your application trial period. For example, you can explicitly state that your application can only be used for 30 days before activating the product.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>While it’s not a bullet proof mechanism, the built-in version provides a sample of how you can configure product activation. <o:p></o:p></FONT></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial">Product Registration <o:p></o:p></SPAN></B></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><FONT size=2>This form makes it dirt simple to enable product registration directly in the product using Web services. Everyone wants to know more information about their customers, heck Visual Studio 2005 is the first version of Visual Studio with in-product registration capabilities.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN><o:p></o:p></FONT></SPAN></P><IMG src="http://www.danfernandez.com/view/view.aspx?ID=144"> 
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial">Product Feedback <o:p></o:p></SPAN></B></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><FONT size=2>Do you want to know what your customers think about your application? Why not add the ability to send feedback directly in the product? This feature enables them to do just that using Web services.<o:p></o:p></FONT></SPAN></P><IMG src="http://www.danfernandez.com/view/view.aspx?ID=145"> 
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial">Exception Handling Reporting<o:p></o:p></SPAN></B></P>
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><FONT size=2>You’ve probably had a Windows application hang on you, where you get a “Send Error Report” message.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>That feature is known as Watson, and the error information is sent to Microsoft where if you have a certificate from Verisign, you can actually pull the dumps for your application. The version in the Shareware Starter Kit is the “poor-man’s Watson”, and it captures information about the thrown exception and records it in a database. That way you can report on your application crashes by date, exception type, version, operating system, all using Web services.</FONT> <o:p></o:p></SPAN></P><IMG src="http://www.danfernandez.com/view/view.aspx?ID=146"> 
<P class=MsoNormal style="MARGIN: 0in -0.5in 0pt 0in"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></B></P>
<P><FONT face=Arial size=2>You can access all the features directly from the included Sample Application Toolstrip as shown below:</FONT><IMG src="http://www.danfernandez.com/view/view.aspx?ID=147"> </P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Walkthrough: An unhandled exception is thrown<o:p></o:p></SPAN></B></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">To show you all the bits and pieces here’s a simplified walkthrough of how the kit works: <o:p></o:p></SPAN></P>
<OL style="MARGIN-TOP: 0in" type=1>
<LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Your exception information is forwarded to the <B style="mso-bidi-font-weight: normal">ExceptionForm</B> Form. <o:p></o:p></SPAN>
<LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Information about the exception is loaded into the ExceptionForm textboxes. <o:p></o:p></SPAN>
<LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">The <B style="mso-bidi-font-weight: normal">ExceptionForm</B> loads up a <B style="mso-bidi-font-weight: normal">DataStore</B> class which loads your application settings from a file “DataStore.dat” in isolated storage to validate if payment information has been received.<o:p></o:p></SPAN> 
<LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">When the user clicks “Submit” a new <B style="mso-bidi-font-weight: normal">ExceptionInfo</B> class is created and populated with information about the exception.<o:p></o:p></SPAN> 
<LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">The <B style="mso-bidi-font-weight: normal">ExceptionInfo</B> class is then sent to the <B style="mso-bidi-font-weight: normal">ServerProcessing</B> class which handles calling all of the Web services. The <B style="mso-bidi-font-weight: normal">ServerProcessing</B> class inspects the incoming type is an <B style="mso-bidi-font-weight: normal">ExceptionInfo</B> type, and if so, calls the <B style="mso-bidi-font-weight: normal">SubmitException</B> Web service.<o:p></o:p></SPAN> 
<LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">The SubmitException WebMethod is a Web Method in the SharewareService WebService class. Below is the declaration of the class, note the Basic Profile&nbsp;compliance attribute for interoperability.<o:p></o:p></SPAN></LI></OL>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p></o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'; mso-no-proof: yes"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>[<SPAN style="COLOR: teal">WebService</SPAN>(Namespace = <SPAN style="COLOR: maroon">"http://tempuri.org/"</SPAN>)]<o:p></o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'; mso-no-proof: yes"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>[<SPAN style="COLOR: teal">WebServiceBinding</SPAN>(ConformsTo = <SPAN style="COLOR: teal">WsiProfiles</SPAN>.BasicProfile1_1)]<o:p></o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'; mso-no-proof: yes"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: blue">public</SPAN> <SPAN style="COLOR: blue">class</SPAN> <SPAN style="COLOR: teal">SharewareService</SPAN> : System.Web.Services.<SPAN style="COLOR: teal">WebService<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'; mso-no-proof: yes"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>{...}</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p></o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p>&nbsp;</o:p></SPAN></P>
<OL style="MARGIN-TOP: 0in" type=1 start=7>
<LI class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">The SubmitException Web Service validates the input and checks for SQL injection, then calls the DB classes <STRONG>SubmitException </STRONG>method that uses a DAL to call the <B style="mso-bidi-font-weight: normal">SubmitException</B> stored procedure in the SSK Database, which in turn adds the data to the <B style="mso-bidi-font-weight: normal">SSK_Exception</B> table. Below is a list of the database tables and stored procedures in the SSK database.<o:p></o:p></SPAN></LI></OL>
<P>
<P><B><FONT face=Arial size=2>Database Tables<BR></FONT></B><FONT face=Arial size=2><IMG src="http://www.danfernandez.com/view/view.aspx?ID=148"> </FONT></P>
<P></P>
<P><B><FONT face=Arial size=2>Database Stored Procedures<BR></FONT></B><FONT face=Arial size=2><IMG src="http://www.danfernandez.com/view/view.aspx?ID=149"> </FONT></P>
<P></P>
<P><FONT face=Arial size=2>Here’s a view of the architecture (pics from the included documentation) showing both the client and server architecture. </FONT></P>
<P><B><FONT face=Arial size=2>Client Architecture</FONT></B></P><IMG src="http://www.danfernandez.com/view/view.aspx?ID=150"> 
<P><STRONG><FONT face=Arial size=2></FONT></STRONG>&nbsp;</P>
<P><FONT face=Arial size=2></FONT></P>
<P><B><FONT face=Arial size=2>Server Architecture</FONT></B></P><IMG src="http://www.danfernandez.com/view/view.aspx?ID=151"> 
<P><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">We Want Your Feedback<BR></SPAN></B><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Send us your feedback! The Shareware Starter Kit is in beta and we want your feedback and comments on the feature design, new features and anything in-between. We are currently also working on a fully unmanaged (at least from the client side) C++ version of the Shareware Starter Kit and an Avalon/Indigo version of the kit. </SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p>Special thanks to <A href="http://www.personifydesign.com">Personify Design </A>who did the design and development&nbsp;of the kit and <A href="http://www.foundstone.com">Foundstone</A> for the security review.</o:p></SPAN></P>
<P>&nbsp;</P></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
