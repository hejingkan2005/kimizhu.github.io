<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>LINQ: What is the purpose of var?</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/Dan Fernandez - MSFT' target='_blank'>Dan Fernandez - MSFT</a>
<time>    9/22/2005 1:36:00 PM</time>
<hr>
<div id='content'><P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><A href="https://channel9.msdn.com/Niners/Larsenal"><FONT color=#000080>Larsenal</FONT></A>, a C9’er posted a comment <FONT style="BACKGROUND-COLOR: #ffffff">on</FONT> the <A href="https://channel9.msdn.com/ShowPost.aspx?PostID=115804"><FONT style="BACKGROUND-COLOR: #ffffff" color=#000080>C9 forums</FONT></A> about the <A href="https://channel9.msdn.com/Showpost.aspx?postid=114680"><FONT color=#000080>Introducing LINQ video</FONT></A> and asked a really good question so I thought I should repost my response here. <?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></SPAN></P>
<P><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Larsenal's Question<BR></SPAN></B><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">“<I style="mso-bidi-font-style: normal">I've watched <A href="http://download.microsoft.com/download/4/7/0/4703eba2-78c4-4b09-8912-69f6c38d3a56/LanguageEnhancements.wmv" target=_blank><FONT style="BACKGROUND-COLOR: #ffffff" color=#000080>this</FONT></A> video on LINQ in C#.&nbsp; If the type is set at compile time, what's the benefit of using the "var" keyword?&nbsp; It seems like it just makes the code less readable.<BR><BR>I look at the first example <a href="http://blogs.msdn.com/danielfe/archive/2005/09/13/464904.aspx" target=_blank><FONT color=#000080>here</FONT></A>, and wonder why not just replace the <SPAN style="mso-bidi-font-style: italic">var</SPAN> with <SPAN style="mso-bidi-font-style: italic">string[]?”</SPAN></I><B style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN></P>
<P><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">My (slightly modified) Answer<BR></SPAN></B><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">If you’ve never heard of var, var is a new way to declare variables in C# 3.0 that uses implicit typing. Let’s show a quick couple of examples.<o:p></o:p></SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Before 3.0<BR>string myString = “hello”;<BR>int myInt = 5;<BR>float myFloat = 5.5f;<o:p></o:p></SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">After 3.0<BR>var myString = “hello”;<BR>var myInt = 5;<BR>var myFloat = 5.5f;<o:p></o:p></SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">The distinction here is that var is not the same as object, or the JavaScript “var” data type as it’s actually strongly typed, but <STRONG>inferred</STRONG> from whatever the value is being assigned.<o:p></o:p></SPAN></P>
<P><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">Create your own types with var<BR></SPAN></B><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">The big reason for var in my opinion is that LINQ enables you to&nbsp;create or "project"&nbsp;wholly new data types without having to create the type themselves. This is known as <STRONG><SPAN style="FONT-FAMILY: Arial">projection</SPAN></STRONG>.<BR><BR>Let's look at a sample query that <a href="http://blogs.msdn.com/danielfe/archive/2005/09/13/464904.aspx">I blogged about earlier</A>:<B style="mso-bidi-font-weight: normal"><o:p></o:p></B></SPAN></P>
<P style="MARGIN-BOTTOM: 12pt"><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'; mso-no-proof: yes">string</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes">[] aBunchOfWords = {<SPAN style="COLOR: maroon">"One"</SPAN>,<SPAN style="COLOR: maroon">"Two"</SPAN>, <SPAN style="COLOR: maroon">"Hello"</SPAN>, <SPAN style="COLOR: maroon">"World"</SPAN>, <SPAN style="COLOR: maroon">"Four"</SPAN>, <SPAN style="COLOR: maroon">"Five"</SPAN>};</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'"><o:p></o:p></SPAN></P>
<P style="MARGIN-BOTTOM: 12pt"><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">var</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> result = <BR><SPAN style="COLOR: blue">from</SPAN> s <SPAN style="COLOR: blue">in</SPAN> aBunchOfWords <BR><SPAN style="COLOR: blue">where</SPAN> s.Length == 5<BR><SPAN style="COLOR: blue">select</SPAN> s;<BR><BR></SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">In this example, I am&nbsp;projecting the string "s",&nbsp; so I could have easily replaced var with the type IEnumerable&lt;string&gt; as shown in bold below and my code would have worked fine.</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><o:p></o:p></SPAN></P>
<P style="MARGIN-BOTTOM: 12pt"><STRONG><SPAN style="FONT-SIZE: 10pt; COLOR: teal; FONT-FAMILY: 'Courier New'">IEnumerable</SPAN></STRONG><STRONG><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">&lt;<SPAN style="COLOR: blue">string</SPAN>&gt; </SPAN></STRONG><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">result = <BR><SPAN style="COLOR: blue">from</SPAN> s <SPAN style="COLOR: blue">in</SPAN> aBunchOfWords <BR><SPAN style="COLOR: blue">where</SPAN> s.Length == 5<BR><SPAN style="COLOR: blue">select</SPAN> s;<BR><BR></SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">But what if I wanted to project something more complex, like a type that contains&nbsp;<BR>1) the string<BR>2) the length&nbsp;of the string&nbsp;as an integer<BR>3) the first three characters of the substring<BR><BR>Using the power of var, this is pretty easy as shown in bold below:</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><o:p></o:p></SPAN></P>
<P><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">var</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> result = <BR><SPAN style="COLOR: blue">from</SPAN> s <SPAN style="COLOR: blue">in</SPAN> aBunchOfWords <BR><SPAN style="COLOR: blue">where</SPAN> s.Length == 5 <BR><SPAN style="COLOR: green">//Creates a new anonymous type with name/value pairs</SPAN><SPAN style="COLOR: blue"><BR><STRONG><SPAN style="FONT-FAMILY: 'Courier New'">select</SPAN></STRONG></SPAN><STRONG><SPAN style="FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">new</SPAN> {Value=s, Length=s.Length, FirstThreeLetters=s.Substring(0,3)}</SPAN></STRONG>;<o:p></o:p></SPAN></P>
<P style="MARGIN-BOTTOM: 12pt"><SPAN style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">//Print values&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'"><BR>foreach</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> (<SPAN style="COLOR: blue">var</SPAN> x <SPAN style="COLOR: blue">in</SPAN> result)<BR><SPAN style="COLOR: teal">Console</SPAN>.WriteLine(<SPAN style="COLOR: maroon">"Value: {0}, Length:{1}, SubString:{2}"</SPAN>, <BR>x.Value, x.Length, x.FirstThreeLetters);<BR></SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><BR>This prints:<BR></SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">Value: Hello, Length:5, SubString:Hel<BR>Value: World, Length:5, SubString:Wor<BR><BR></SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: Arial">As you can see, I can use "select new" and project my own custom type with field name/value pairs. Under the covers var&nbsp;<B style="mso-bidi-font-weight: normal">infers</B> the field names, field values, and field data types and creates an anonymous type with&nbsp;the three fields I projected.<BR><BR>Without var, you would have to create the anonymous type yourself, which basically means you have to create a custom class for the projected type&nbsp;as shown below:</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'"><o:p></o:p></SPAN></P>
<P style="MARGIN-BOTTOM: 12pt"><STRONG><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">public</SPAN></STRONG><STRONG><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">class</SPAN> <SPAN style="COLOR: teal">MyType</SPAN></SPAN></STRONG><B><SPAN style="FONT-SIZE: 10pt; COLOR: teal; FONT-FAMILY: 'Courier New'"><BR></SPAN></B><STRONG><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">{</SPAN></STRONG><B><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><BR><SPAN style="mso-spacerun: yes">&nbsp; </SPAN><STRONG><SPAN style="COLOR: blue; FONT-FAMILY: 'Courier New'">public</SPAN></STRONG><STRONG><SPAN style="FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">string</SPAN> Value;</SPAN></STRONG><BR><SPAN style="mso-spacerun: yes">&nbsp; </SPAN><STRONG><SPAN style="COLOR: blue; FONT-FAMILY: 'Courier New'">public</SPAN></STRONG><STRONG><SPAN style="FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">int</SPAN> Length;</SPAN></STRONG><BR><SPAN style="mso-spacerun: yes">&nbsp; </SPAN><STRONG><SPAN style="COLOR: blue; FONT-FAMILY: 'Courier New'">public</SPAN></STRONG><STRONG><SPAN style="FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">string</SPAN> FirstThreeLetters;</SPAN></STRONG><BR><STRONG><SPAN style="FONT-FAMILY: 'Courier New'">}<o:p></o:p></SPAN></STRONG></SPAN></B></P>
<P style="MARGIN-BOTTOM: 12pt"><STRONG><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-bidi-font-weight: bold">The subsequent code would work like shown below (using another new feature, object initializers):</SPAN></STRONG><B style="mso-bidi-font-weight: normal"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p></o:p></SPAN></B></P>
<P><STRONG><SPAN style="FONT-SIZE: 10pt; COLOR: teal; FONT-FAMILY: 'Courier New'">IEnumerable</SPAN></STRONG><STRONG><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">&lt;<SPAN style="COLOR: teal">MyType</SPAN>&gt;</SPAN></STRONG><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> result = <BR><SPAN style="COLOR: blue">from</SPAN> s <SPAN style="COLOR: blue">in</SPAN> aBunchOfWords <BR><SPAN style="COLOR: blue">where</SPAN> s.Length == 5 <BR><STRONG><SPAN style="COLOR: blue; FONT-FAMILY: 'Courier New'">select</SPAN></STRONG><STRONG><SPAN style="FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">new</SPAN> <SPAN style="COLOR: teal">MyType</SPAN> {Value=s, Length=s.Length, FirstThreeLetters=s.Substring(0,3)}</SPAN></STRONG>;<BR><BR></SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">While I get the same results as in the previous example, you can see how var saves me the trouble of defining my own type. In the&nbsp;var example, the compiler is creating its own version of&nbsp;the "MyType" class, but you as a LINQ developer don't need to worry about that, but&nbsp;If you really don't like var, you can of course manually create your own class and map them to LINQ queries as I showed above and everything will still "just work". <BR><BR>When you're dealing with projection, var is awesome in that it really eliminates the grunt work of defining your own type, which, when you get to nested types can be pretty ugly :)<BR><BR>You can find a whole slew of projection operator samples at: <A href="http://msdn.microsoft.com/vcsharp/future/linqsamples/projection/default.aspx" target=_blank><FONT color=#000080>http://msdn.microsoft.com/vcsharp/future/linqsamples/projection/default.aspx</FONT></A><BR style="mso-special-character: line-break"><BR style="mso-special-character: line-break"></SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><o:p></o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><o:p>&nbsp;</o:p></P></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
